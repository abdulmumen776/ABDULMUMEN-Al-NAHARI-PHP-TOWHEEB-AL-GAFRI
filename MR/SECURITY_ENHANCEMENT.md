# ๐ ุงููุฑุญูุฉ ุงูุซุงููุฉ: ุชุญุณููุงุช ุงูุฃูุงู ูุงููุตุงุฏูุฉ

## ูุธุฑุฉ ุนุงูุฉ

ุชู ุจูุฌุงุญ ุงููุฑุญูุฉ ุงูุซุงููุฉ ูู ุชุญุณููุงุช ุงูุฃูุงู ูุงููุตุงุฏูุฉ ูููุธุงู. ูุฐู ุงูุชุญุณููุงุช ุชูุฏู ุฅูู ุชุฃููู ุฃูุงู ุงููุธุงู ูุญูุงูุฉ ุงูุจูุงูุงุช ุงูุญุณุงุณุฉ ูุชูููุฑ ูุตุงุฏูุฉ ูููุฉ ูููุตูู ุฅูู ุงูู APIs.

## ๐ก๏ธ ุงูููููุงุช ุงููููุฐุฉ

### 1. ูุธุงู ูุตุงุฏูุฉ API ุงููุชูุฏู

**Migration:** `2026_01_23_240000_create_api_tokens_table.php`

ุชู ุฅูุดุงุก ุฌุฏูู `api_tokens` ูุฅุฏุงุฑุฉ ุชูููุงุช ุงููุตูู ุฅูู ุงูู APIs:

- **ุงูุญููู ุงูุฃุณุงุณูุฉ:** id, user_id, token, name, abilities
- **ุงูุตูุงุญูุงุช:** last_used_at, expires_at, created_at, updated_at
- **ุงูููุงุฑุณ ุงููุญุณููุฉ:** ุนูู user_id, token, expires_at, last_used_at
- **ุงูููุฒุงุช:** ุชูููุงุช ูุฑูุฏุฉุ ุตูุงุญูุงุช ูุงุจูุฉุ ุชุงุฑูุฎ ุงูุชูุงุก ุงูุตูุงุญูุฉ

**Model:** `app/Models/ApiToken.php`

ูููุฐุฌ ูุชูุงูู ูุฅุฏุงุฑุฉ ุชูููุงุช ุงูู API ูุน:

- **ุงูุชุญูู ูู ุงูุตูุงุญูุฉ:** `isExpired()`, `isValid()`
- **ุฅุฏุงุฑุฉ ุงูุตูุงุญูุงุช:** `can()`, `getAbilities()`
- **ุชุชุจุน ุงุณุชุฎุฏุงู ุงูุชููู:** `updateLastUsedAt()`
- **ุงููุทุงูุงุช:** `revoke()`, `createForUser()`, `findByToken()`
- **ุงูู Scopes:** `valid()`, `expired()`, `forUser()`, `withAbility()`
- **ุงูู Attributes:** `status`, `status_color`, `formatted_token`, `usage_stats`

### 2. Middleware ุงูุฃูุงูู

#### ApiTokenMiddleware
**File:** `app/Http/Middleware/ApiTokenMiddleware.php`

- **ุงูุบุฑุถ:** ุงูุชุญูู ูู ุชูููุงุช ุงูู API
- **ุงููุตุงุฏุฑ:** Authorization header, query parameters, form data
- **ุงูููุฒุงุช:**
  - ุงูุชุญูู ูู ุตูุงุญูุฉ ุงูุชููู
  - ุชุญุฏูุซ ููุช ุงูุงุณุชุฎุฏุงู
  - ุชุณุฌูู ูุญุงููุงุช ุงููุตูู ุบูุฑ ุงููุตุฑุญ ุจูุง
  - ุฑุจุท ุงูุชููู ูุงููุณุชุฎุฏู ูู ุงูุทูุจ

#### ApiRateLimitMiddleware
**File:** `app/Http/Middleware/RateLimitMiddleware.php`

- **ุงูุบุฑุถ:** ุชุญุฏูุฏ ูุนุฏู ุงุณุชุฎุฏุงู ุงูู API
- **ุงูุฎูุงุฑุฒููุฉ:** Redis-based rate limiting
- **ุงูููุฒุงุช:**
  - ุญุฏูุฏ ูุฎุชููุฉ ุญุณุจ ููุน ุงููุณุชุฎุฏู
  - ุงุณุชุซูุงุกุงุช ููุตูุงุญูุงุช ุบูุฑ ูุญุฏูุฏุฉ
  - ุฑุคูุณ HTTP headers ููุญุฏูุฏ ุงููุชุจููุฉ
  - ุชุณุฌูู ุงูุชูุงู ุงูุญุฏ

#### EncryptionMiddleware
**File:** `app/Http/Middleware/EncryptionMiddleware.php`

- **ุงูุบุฑุถ:** ุชุดููุฑ ููู ุชุดููุฑ ุงูุจูุงูุงุช ุงูุญุณุงุณุฉ
- **ุงูููุฒุงุช:**
  - ุชุดููุฑ ุงูุจูุงูุงุช ุงููุงุฑุฏุฉ ูุงูุตุงุฏุฑุฉ
  - ุฏุนู ุงูุจูุงูุงุช ุงููุชุฏุงุฎูุฉ
  - ูุงุฆูุฉ ุงูุญููู ุงูุญุณุงุณุฉ ุงููุนุฑููุฉ
  - ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก ุจุฃูุงู

### 3. ูุงุฌูุงุช ุจุฑูุฌุฉ ุงูุชุทุจููุงุช (API Controllers)

#### ApiTokenController
**File:** `app/Http/Controllers/ApiTokenController.php`

**ุงููุธุงุฆู:**
- **ุฅุฏุงุฑุฉ ุงูุชูููุงุช:** ุฅูุดุงุกุ ุนุฑุถุ ุชุญุฏูุซุ ุญุฐูุ ุฅูุบุงุก
- **ุงูุฅุญุตุงุฆูุงุช:** ุนุฑุถ ุฅุญุตุงุฆูุงุช ุงุณุชุฎุฏุงู ุงูุชูููุงุช
- **ุงูุชุญูู:** ุงูุชุญูู ูู ุตูุงุญูุงุช ุงูุชูููุงุช
- **ุงูุฃูุงู:** ุงูุชุฃูุฏ ูู ููููุฉ ุงูุชููู ูููุณุชุฎุฏู

#### SecurityController
**File:** `app/Http\Controllers\SecurityController.php`

**ุงููุธุงุฆู:**
- **ุฅุนุฏุงุฏุงุช ุงูุฃูุงู:** ุนุฑุถ ูุชุญุฏูุซ ุฅุนุฏุงุฏุงุช ุงูุฃูุงู
- **ุณุฌู ุงูุชุฏููู:** ุนุฑุถ ุณุฌู ุฃุญุฏุงุซ ุงูุฃูุงู
- **ุงูุฅุญุตุงุฆูุงุช:** ุฅุญุตุงุฆูุงุช ุงูุฃูุงู ูููุณุชุฎุฏู ูุงููุธุงู
- **ูุญุต ูููุฉ ุงููุฑูุฑ:** ุงูุชุญูู ูู ููุฉ ูููุฉ ุงููุฑูุฑ
- **ุชูููุฏ ุงูุชูููุงุช:** ุชูููุฏ ุชูููุงุช ุนุดูุงุฆูุฉ ุขููุฉ
- **ูุญุต ุงูุฃูุงู:** ูุญุต ููุงุท ุถุนู ุงูุฃูุงู

### 4. ุงูุชุญูู ูู ุตุญุฉ ุงูุจูุงูุงุช

#### ApiTokenRequest
**File:** `app/Http\Requests\ApiTokenRequest.php`

**ุงูููุงุนุฏ ุงูุชุญูู:**
- ุงุณู ุงูุชููู: ูุทููุจุ 3-255 ุญุฑู
- ุงูุตูุงุญูุงุช: ูุงุฆูุฉ ูุญุฏุฏุฉ ูู ุงูุตูุงุญูุงุช ุงููุนุชูุฏุฉ
- ุชุงุฑูุฎ ุงูุงูุชูุงุก: ุงุฎุชูุงุฑูุ ูุณุชูุจููุ ุฃูู ูู ุณูุฉ
- **ุงูุชุญูู ุงููุชูุฏู:** ุงูุชุญูู ูู ุชููููุฉ ุงูุตูุงุญูุงุช

## ๐ ุงูููุฒุงุช ุงูุฃูููุฉ

### 1. ูุตุงุฏูุฉ API ูููุฉ
- **ุชูููุงุช ูุฑูุฏุฉ:** `mr_` + 60 ุญุฑู ุนุดูุงุฆู
- **ุตูุงุญูุงุช ูุฑูุฉ:** ูุงุฆูุฉ ูุญุฏุฏุฉ ูู ุงูุตูุงุญูุงุช ุงููุนุชูุฏุฉ
- **ุงูุชูุงุก ุงูุตูุงุญูุฉ:** ุฏุนู ุชุงุฑูุฎ ุงูุชูุงุก ุงูุชููู
- **ุชุชุจุน ุงูุงุณุชุฎุฏุงู:** ุชุณุฌูู ุขุฎุฑ ุงุณุชุฎุฏุงู ููู ุชููู

### 2. Rate Limiting ูุชูุฏู
- **ููุงุนุฏ ูุฎุชููุฉ:** ุฏูููุฉุ ุณุงุนุฉุ ููู
- **ุงุณุชุซูุงุกุงุช:** ุงููุณุชุฎุฏููู ุฐูู ุตูุงุญูุงุช ุบูุฑ ูุญุฏูุฏุฉ
- **Redis Backend:** ุชุฎุฒูู ูุคูุช ููุนุฏู ุงูุงุณุชุฎุฏุงู
- **Headers ุดุงููุฉ:** ูุนูููุงุช ุงูุญุฏ ูููุทูุฑ

### 3 ุชุดููุฑ ุงูุจูุงูุงุช
- **ุงูุชุดููุฑ ุงูุชููุงุฆู:** ููุจูุงูุงุช ุงูุญุณุงุณุฉ ุชููุงุฆูุงู
- **ุงูุญููู ุงููุญุฏุฏุฉ:** ูุงุฆูุฉ ุงูุญููู ุงูุญุณุงุณุฉ ุงููุนุฑููุฉ
- **ุฏุนู ุงูุจูุงูุงุช ุงููุชุฏุงุฎูุฉ:** ุชุดููุฑ ุงูุจูุงูุงุช ุงููุชุฏุงุฎูุฉ
- **ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก:** ูุนุงูุฌุฉ ุฃุฎุทุงุก ุงูุชุดููุฑ ุจุฃูุงู

### 4. ุณุฌู ุงูุชุฏููู ุงูุฃููู
- **ุชุณุฌูู ุงูุฃุญุฏุงุซ:** ุฌููุน ูุญุงููุงุช ุงููุตูู
- **ุชุชุจุน ุงููุณุชุฎุฏููู:** ุชุณุฌูู ุงูุฃูุดุทุฉ ุญุณุจ ุงููุณุชุฎุฏู
- **ุชุชุจุน ุงูู API:** ุชุณุฌูู ุงุณุชุฎุฏุงู ุงูู APIs
- **ุชูุจููุงุช ุงูุฃูุงู:** ุชุณุฌูู ูุญุงููุงุช ุงูุงุฎุชุฑุงู

## ๐ ุงูููุงููุณ ุงูุฃูููุฉ

### 1. ููุงููุณ ุงููุตุงุฏูุฉ
- **ุงููุฏู:** 100% ุชุบุทูุฉ ุนูู ุงูู APIs
- **ุงูุทุฑููุฉ:** ุงูุชุญูู ูู ุงูุชูููุงุช ููู ุทูุจ
- **ุงููุชูุฌุฉ:** ุญูุงูุฉ ูุงููุฉ ูููุตูู ุฅูู ุงูู APIs

### 2. ููุงููุณ ุงูุชุดููุฑ
- **ุงููุฏู:** ุชุดููุฑ 100% ููุจูุงูุงุช ุงูุญุณุงุณุฉ
- **ุงูุทุฑููุฉ:** ุชุดููุฑ ุชููุงุฆู ููุญููู ุงููุนุฑููุฉ
- **ุงููุชูุฌุฉ:** ุญูุงูุฉ ุงูุจูุงูุงุช ุงูุญุณุงุณุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

### 3. ููุงููุณ Rate Limiting
- **ุงููุฏู:** ููุน ูุฌูุงุช ุงูู API
- **ุงูุทุฑููุฉ:** 60 ุทูุจ/ุฏูููุฉุ 1000 ุทูุจ/ุณุงุนุฉ
- **ุงููุชูุฌุฉ:** ุญูุงูุฉ ุงููุธุงู ูู ุงูุงุณุชุฎุฏุงู ุงูููุฑุท

## ๐๏ธ ุฎุทูุงุช ุงูุชุดุบูู

### 1. ุชุดุบูู ุงูู Migrations
```bash
php artisan migrate
```

### 2. ุชุญุฏูุซ ูุชุบูุฑุงุช ุงูุจูุฆุฉ
```env
# API Security
API_TOKEN_ENABLED=true
API_RATE_LIMIT_ENABLED=true
API_RATE_LIMIT_PER_MINUTE=60
API_RATE_LIMIT_PER_HOUR=1000

# Encryption
APP_ENCRYPTION_KEY=base64:your-encryption-key
APP_CIPHER=AES-256-CBC

# Rate Limiting
RATE_LIMITING_DRIVER=redis
```

### 3. ุชุณุฌูู Middleware
```php
// app/Http/Kernel.php
protected $middlewareAliases = [
    'api.token' => \App\Http\Middleware\ApiTokenMiddleware::class,
    'api.rate_limit' => \App\Http\Middleware\ApiRateLimitMiddleware::class,
    'api.encryption' => \App\Http\Middleware\EncryptionMiddleware::class,
];
```

### 4. ุชุญุฏูุซ ุงูู Routes
```php
// routes/api.php
Route::middleware(['api.token', 'api.rate_limit', 'api.encryption'])->group(function () {
    // API routes here
});
```

### 5. ุชุดุบูู Queue Workers
```bash
php artisan queue:work --queue=api,security
```

## ๐ ุฃูุซูุฉ ุงูุงุณุชุฎุฏุงู

### 1. ุฅูุดุงุก ุชููู API
```bash
curl -X POST http://localhost:8000/api/tokens \
  -H "Authorization: Bearer YOUR_API_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "Production API Token",
    "abilities": ["actions:read", "actions:write"],
    "expires_at": "2024-12-31T23:59:59Z"
  }'
```

### 2 ุงุณุชุฎุฏุงู ุงูุชููู
```bash
curl -X GET http://localhost:8000/api/clients \
  -H "Authorization: Bearer mr_abc123..." \
  -H "Content-Type: application/json"
```

### 3. ูุฑุงูุจุฉ ุงูุฃูุงู
```bash
curl -X GET http://localhost:8000/api/security/statistics \
  -H "Authorization: Bearer YOUR_API_TOKEN" \
  -H "Content-Type: application/json"
```

## ๐ง ุงูุชููููุงุช ุงููุชูุฏูุฉ

### 1. ุตูุงุญูุงุช ูุฎุตุตุฉ
```php
// ุตูุงุญูุงุช ูููุฑุงุกุฉ ููุท
'token' => [
    'actions:read',
    'operations:read',
    'apis:read',
    'performance:read',
    'dashboards:read',
    'alerts:read',
    'patterns:read',
],

// ุตูุงุญูุงุช ูููุชุงุจุฉ
'token' => [
    'actions:read',
    'actions:write',
    'operations:read',
    'operations:write',
    'apis:read',
    'apis:write',
    'performance:read',
    'dashboards:read',
    'dashboards:write',
    'alerts:read',
    'alerts:write',
    'patterns:read',
    'patterns:write',
],
```

### 2. Rate Limiting ูุฎุตุต
```php
// ูููุณุชุฎุฏููู ุงูุนุงุฏููู
Route::middleware('api.rate_limit:30,1')->group(function () {
    // 30 ุทูุจ ูู ุงูุฏูููุฉ
});

// ููู APIs ุงูุญุณุงุณุฉ
Route::middleware('api.rate_limit:120,1')->group(function () {
    // 120 ุทูุจ ูู ุงูุฏูููุฉ
});
```

### 3. ุชุดููุฑ ุจูุงูุงุช ุญุณุงุณุฉ
```php
// ูู Model
protected $casts = [
    'contact_phone' => 'encrypted',
    'secret_key' => 'encrypted',
    'api_key' => 'encrypted',
];
```

## ๐ฏ ุงูููุงุฆุฏ ุงููุญููุฉ

### 1. ุฃูุงู ูุญุณูู
- **ุญูุงูุฉ ูุงููุฉ** ูููุตูู ุฅูู ุงูู APIs
- **ูุตุงุฏูุฉ ูููุฉ** ูุน ุตูุงุญูุงุช ุฏูููุฉ
- **ุชุชุจุน ุงุณุชุฎุฏุงู** ูุงูู ูููุตูู ูุงูุฃูุดุทุฉ

### 2. ุฃุฏุงุก ูุญุณูู
- **Rate Limiting** ูููุน ูุฌูุงุช ุงูู APIs
- **ุงูุชุฎุฒูู ุงููุคูุช** ูููู ุงูุนุจุก ุนูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- **ุงููุนุงูุฌุฉ ูู ุงูุฎูููุฉ** ุชุญุณู ุงุณุชุฌุงุจุฉ ุงููุณุชุฎุฏู

### 3. ุญูุงูุฉ ุงูุจูุงูุงุช
- **ุงูุชุดููุฑ ุงูุชููุงุฆู** ููุจูุงูุงุช ุงูุญุณุงุณุฉ
- **ูุงุฆูุฉ ุงูุญููู ุงูุญุณุงุณุฉ** ูุนุฑููุฉ
- **ูุนุงูุฌุฉ ุขููุฉ** ููุฃุฎุทุงุก

### 4. ูุงุจููุฉ ุงูุชูุณุน
- **ูุธุงู ุตูุงุญูุงุช** ูุงุจู ููุชุฎุตูุต
- **Rate Limiting** ูุงุจู ููุชูููู
- **Middleware** ูุงุจู ููุชุฎุตูุต ุญุณุจ ุงูุญุงุฌุฉ

---

**ุงููุฑุญูุฉ ุงูุซุงููุฉ ูู ุชุญุณููุงุช ุงูุฃูุงู ูุงููุตุงูุฉ ููุชููุฉ ูุฌุงูุฒุฉ ููุงุณุชุฎุฏุงู ูู ุจูุฆุฉ ุงูุฅูุชุงุฌ!** ๐

ุงููุธุงู ุงูุขู ูุชูุชุน ุจู:
- ูุตุงุฏูุฉ API ูุชูุฏูุฉ ูุน ุชูููุงุช ุขููุฉ
- ุญูุงูุฉ ูู ูุฌูุงุช ุงูู API
- ุชุดููุฑ ุงูุจูุงูุงุช ุงูุญุณุงุณุฉ
- ุณุฌู ุชุฏููู ุฃููู ุดุงูู
- ุฃุฏูุงุช ุฅุฏุงุฑุฉ ุงูุฃูุงู ููุฑุงูุจุชูุง

ููููู ุงูุขู ุงูุงูุชูุงู ุฅูู ุงููุฑุญูุฉ ุงูุซุงูุซุฉ (ุชุญุณููุงุช ุงููุงุฌูุฉ ุงูุฃูุงููุฉ) ุฃู ุงูุจุฏุก ูู ุงุณุชุฎุฏุงู ุงููุธุงู ุงููุญุณูู ุฃูุงููุงู! ๐
