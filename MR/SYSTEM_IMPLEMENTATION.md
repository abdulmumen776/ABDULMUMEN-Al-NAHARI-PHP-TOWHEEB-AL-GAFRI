# نظام مراقبة الأفراد وإدارة الحركات - تنفيذ كامل

## نظرة عامة على النظام

تم بناء نظام متكامل لمراقبة الأفراد وإدارة حركاتهم بناءً على مخطط تدفق البيانات (DFD) المقدم. النظام يتبنى بنية Laravel مع خدمات منفصلة لمعالجة البيانات ومراقبة الأداء وتحليل الأنماط.

## المكونات المنفذة

### 1. معالجة الإجراءات الأساسية (العمليات 1.1، 1.2، 2.1، 2.2)

- **استقبال الإجراءات**: استلام بيانات الإجراءات من العملاء مع إنشاء إشعارات الاستلام
- **استخراج البيانات الوصفية**: تحليل البيانات الخام واستخراج معلومات منظمة (الطوابع الزمنية، الموقع، المعلمات)
- **التحقق من البيانات**: التحقق من صحة بيانات العملاء والمعاملات باستخدام قواعد تحقق مرنة
- **تخزين البيانات الغنية**: حفظ البيانات المعالجة في قاعدة البيانات مع حالة التحقق

### 2. نظام مراقبة الأداء (العمليات 3.1، 3.2، 3.3، 3.4)

- **مراقبة أداء الخادم**: جمع بيانات CPU، الذاكرة، القرص، والشبكة
- **مراقبة أداء الـ API**: تتبع وقت الاستجابة، معدلات الخطأ، وحجم البيانات
- **تجميع بيانات الأداء**: دمج البيانات من مصادر متعددة وحساب المقاييس الإجمالية
- **حساب مجموعات البيانات**: إنشاء مجموعات بيانات الأداء مع التحليلات المتقدمة

### 3. نظام لوحة التحكم (العمليات 4.1، 4.2، 4.3، 4.4)

- **تنسيق المقاييس**: تهيئة بيانات الأداء للعرض التقديمي
- **توليد مقاييس لوحة التحكم**: إنشاء مؤشرات الأداء والرؤى الصحية
- **عرض مكونات لوحة التحكم**: إنشاء مكونات مرئية (رسوم بيانية، مؤشرات، تنبيهات)
- **عرض التنبيهات**: تنسيق وتقديم التنبيهات النشطة

### 4. تحليل الأنماط وإدارة التنبيهات (العمليات 5.2، 5.3، 6.1)

- **تحليل أنماط الـ API**: اكتشاف الأنماط في بيانات أداء الواجهات البرمجية
- **تحليل أنماط لوحة التحكم**: تحديد الاتجاهات والشذوذ في المقاييس
- **إدارة التنبيهات**: إنشاء وتتبع وإدارة التنبيهات التلقائية
- **تحليل الأنماط العام**: محرك تحليل أنماط متعدد الأغراض

## هيكل قاعدة البيانات

### الجداول الرئيسية

1. **العملاء (Clients)**: معلومات العملاء والجهات الخارجية
2. **الإجراءات (Actions)**: سجل الإجراءات المستلمة من العملاء
3. **البيانات الوصفية للإجراءات (ActionMetadata)**: البيانات المستخرجة من الإجراءات
4. **الإجراءات الغنية (EnrichedActions)**: الإجراءات مع البيانات المضافة
5. **نتائج التحقق (ValidationResults)**: نتائج التحقق من صحة البيانات
6. **مقاييس الأداء (PerformanceMetrics)**: مقاييس أداء النظام
7. **سجلات أداء الـ API (ApiPerformanceLogs)**: سجلات أداء الواجهات البرمجية
8. **مجموعات بيانات الأداء (PerformanceDatasets)**: مجموعات البيانات المحسوبة
9. **لوحات التحكم (Dashboards)**: تكوينات لوحات التحكم
10. **المرئيات (DashboardVisualizations)**: مكونات العرض المرئي
11. **نتائج تحليل الأنماط (PatternAnalysisResults)**: نتائج تحليل الأنماط
12. **التنبيهات (Alerts)**: التنبيهات النشطة والمحلولة

## واجهات برمجة التطبيقات (APIs)

### واجهات معالجة الإجراءات
- `POST /api/actions/receive` - استقبال إجراء جديد
- `POST /api/actions/{id}/validate` - التحقق من إجراء
- `GET /api/actions/{id}` - عرض تفاصيل الإجراء
- `GET /api/actions/{id}/acknowledgment` - الحصول على إشعار الاستلام

### واجهات مراقبة الأداء
- `POST /api/performance/monitor/server` - مراقبة أداء الخادم
- `POST /api/performance/monitor/api` - مراقبة أداء API محدد
- `POST /api/performance/monitor/apis` - مراقبة جميع الـ APIs
- `POST /api/performance/aggregate` - تجميع بيانات الأداء
- `POST /api/performance/calculate` - حساب مجموعة بيانات الأداء
- `POST /api/performance/complete` - تنفيذ سير عمل كامل

### واجهات لوحة التحكم
- `GET /api/dashboard` - قائمة لوحات التحكم
- `POST /api/dashboard/format-metrics` - تنسيق المقاييس
- `POST /api/dashboard/generate-metrics` - توليد مقاييس لوحة التحكم
- `POST /api/dashboard/{id}/render-components` - عرض مكونات لوحة التحكم
- `POST /api/dashboard/render-alerts` - عرض التنبيهات
- `POST /api/dashboard/{id}/generate-complete` - تنفيذ سير عمل كامل

### واجهات تحليل الأنماط والتنبيهات
- `POST /api/patterns/analyze-api` - تحليل أنماط الـ API
- `POST /api/patterns/analyze-dashboard` - تحليل أنماط لوحة التحكم
- `POST /api/patterns/analyze` - تحليل الأنماط العام
- `POST /api/patterns/manage-alerts` - إدارة التنبيهات
- `POST /api/patterns/complete-workflow` - تنفيذ سير عمل كامل
- `GET /api/alerts/active` - التنبيهات النشطة
- `POST /api/alerts/{id}/resolve` - حل تنبيه

## الخدمات (Services)

### 1. ActionReceptionService
معالجة استلام الإجراءات وإنشاء الإشعارات

### 2. MetadataExtractionService
استخراج البيانات الوصفية من البيانات الخام

### 3. DataValidationService
التحقق من صحة بيانات العملاء والمعاملات

### 4. PerformanceMonitoringService
مراقبة أداء الخادم والـ API وتحليل البيانات

### 5. DashboardService
إنشاء وتقديم مكونات لوحة التحكم المرئية

### 6. PatternAnalysisService
تحليل الأنماط في البيانات المختلفة

### 7. AlertManagementService
إدارة دورة حياة التنبيهات

## خطوات التثبيت والتشغيل

### 1. إعداد قاعدة البيانات
```bash
php artisan migrate
```

### 2. تشغيل الخادم
```bash
php artisan serve
```

### 3. تشغيل قائمة الانتظار (للمعالجة في الخلفية)
```bash
php artisan queue:work
```

### 4. بناء الواجهة الأمامية
```bash
npm run build
```

## أمثلة على الاستخدام

### استقبال إجراء جديد
```bash
curl -X POST http://localhost:8000/api/actions/receive \
  -H "Content-Type: application/json" \
  -d '{
    "client_id": 1,
    "action_type": "movement",
    "action_data": {
      "location": {"lat": 24.7136, "lng": 46.6753},
      "timestamp": "2026-01-23T21:00:00Z",
      "user_id": "user123"
    }
  }'
```

### مراقبة أداء الخادم
```bash
curl -X POST http://localhost:8000/api/performance/monitor/server
```

### تحليل الأنماط
```bash
curl -X POST http://localhost:8000/api/patterns/analyze \
  -H "Content-Type: application/json" \
  -d '{
    "data": [
      {"response_time_ms": 150, "success": true},
      {"response_time_ms": 200, "success": true}
    ],
    "analysis_type": "api_patterns"
  }'
```

## ملاحظات هامة

1. **الأمان**: يجب تكوين المصادقة والتفويض للواجهات البرمجية
2. **الأداء**: يوصى باستخدام Redis للتخزين المؤقت وقائمة الانتظار
3. **المراقبة**: يمكن دمج النظام مع أنظمة المراقبة الخارجية
4. **التوسع**: يدعم النظام التوسع الأفقي باستخدام موازنة التحميل

## التطويرات المستقبلية

1. **واجهة مستخدم رسومية**: تطوير واجهة ويب تفاعلية
2. **التعلم الآلي**: إضافة نماذج تعلم آلي للتنبؤ
3. **التكامل**: دمج مع أنظمة المراقبة الخارجية
4. **التحليلات المتقدمة**: إضافة تحليلات أكثر تعقيداً

---

**النظام جاهز للاستخدام ويمكن توسيعه حسب المتطلبات المستقبلية.**
